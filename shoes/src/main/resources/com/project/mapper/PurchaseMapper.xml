<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.mapper.PurchaseMapper">


        <!-- 주문 등록       주문한 테이블에서 현재 최대 주문 ID의 값을 가져와서 SELECT 문을 사용-->
    <insert id="Purchase">
    
     <selectKey resultType="int" keyProperty="orderId" order="BEFORE">
        SELECT MAX(orderId)+1 FROM orders       
    </selectKey> 
    
	    insert into orders(memberId, orderProduct, orderAddress, orderPhone, Price, totalPrice, orderPayment)
        values(#{memberId}, #{orderProduct}, #{orderAddress}, #{orderPhone}, #{Price}, #{totalPrice}, #{orderPayment);
     </insert>
     
     <!-- 주문 상세 등록 -->
	<insert id="PurchaseDetaill">
		insert into purchases(orderId, productId, cartAmount) values(#{orderId}, #{productId}, #{cartAmount});
	</insert>
	
	<!-- 주문제품 장바구니 삭제 -->
	<delete id="cartDelete">
		delete from carts where cartId = #{cartId};
	</delete>


</mapper>